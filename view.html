<!DOCTYPE html>
<html lang="tr">
<head>
    <!-- Diğer head içeriği aynı -->
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-clipboard-list"></i> Anonim Liste</h1>
            <p id="listIdDisplay">Liste ID: <span id="listId"></span></p>
        </header>

        <!-- Yeni öğe ekleme formu -->
        <div class="list-controls">
            <input type="text" id="itemName" placeholder="Öğe adı">
            <input type="text" id="itemAmount" placeholder="Miktar">
            <button onclick="addItem()"><i class="fas fa-plus"></i> Ekle</button>
        </div>

        <div class="list-container">
            <div class="list-header">
                <div class="header-name">Öğe</div>
                <div class="header-amount">Miktar</div>
            </div>

            <div class="list-items" id="itemsList">
                <!-- Öğeler buraya eklenecek -->
            </div>
        </div>
    </div>

    <script>
        // Firebase config aynı
        let currentListId = '';
        let currentItems = [];

        // URL'den liste ID'sini al
        const urlParams = new URLSearchParams(window.location.search);
        currentListId = urlParams.get("id");
        document.getElementById("listId").textContent = currentListId;

        // Listeyi yükle
        function loadList() {
            db.collection("lists").doc(currentListId).get()
                .then((doc) => {
                    if (doc.exists) {
                        currentItems = doc.data().items || [];
                        renderItems();
                    }
                });
        }

        // Öğe ekleme fonksiyonu
        function addItem() {
            const name = document.getElementById("itemName").value;
            const amount = document.getElementById("itemAmount").value || "1";

            if (!name) return alert("Lütfen öğe adı girin!");

            currentItems.push({ name, amount });
            
            // Firestore'da güncelle
            db.collection("lists").doc(currentListId).update({
                items: currentItems
            }).then(() => {
                document.getElementById("itemName").value = "";
                document.getElementById("itemAmount").value = "";
                loadList(); // Listeyi yenile
            });
        }

        // Öğeleri render et
        function renderItems() {
            const container = document.getElementById("itemsList");
            container.innerHTML = '';

            currentItems.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-name">${item.name}</div>
                    <div class="item-amount">${item.amount}</div>
                    <button onclick="removeItem(${index})" class="remove-btn">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                container.appendChild(div);
            });
        }

        // Öğe silme fonksiyonu
        function removeItem(index) {
            currentItems.splice(index, 1);
            db.collection("lists").doc(currentListId).update({
                items: currentItems
            }).then(loadList);
        }

        // Sayfa yüklendiğinde listeyi al
        loadList();
    </script>
</body>
</html>
